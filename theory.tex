\documentclass[superscriptaddress, onecolumn, prl]{revtex4}

\usepackage{amsmath}    % need for subequations
\usepackage[pdftex]{graphicx}   % need for figures
\usepackage{verbatim}   % useful for program listings
\usepackage{color}      % use if color is used in text
\usepackage{subfigure}  % use for side-by-side figures
\usepackage{hyperref}   % use for hypertext links, including those to external documents and URLs
\allowdisplaybreaks

\begin{document}
\section{Introduction}
Lets derive a time domain set of equations that describe the evolution of the set of acoustic modes for a cylindrical pipe. The flow in the pipe will be assumed to be described by the velocity potential wave equation. The acoustic modes of the pipe are driven by a small aperture on the left. This flow is the source of both linear and nonlinear driving forces as well as coupling between the different acoustic modes. The right exit of the pipe is assumed to have Robin type dissipative boundary conditions. These boundary conditions take into account the end correction and the acoustic radiation that linearly dissipates energy from the system. This derivation will be done in non non-dimensional variables. You can look at the back for definitions of variables, constants, and the non-dimensionalization. In the following paragraphs the stars will be dropped on the non dimensional variables. 

Let's begin with the initial-boundary value problem for the velocity potential of the acoustic waves in the linear resonator. The first boundary condition indicates that we are driving the pipe with velocity u. The second boundary condition comes from the definition of specific impedance $p=Zu$. We also have from the definition of velocity potential and the linear Euler equation $p=-\frac{\partial \phi (x,t)}{\partial t}$ and $ u = \frac{\partial \phi (x,t)}{\partial x}$. We get the boundary condition by combining these two definitions at the pipe exit. The initial comes from assuming the system starts from rest.
\begin{equation}
\label{eq:wave}
\begin{split}
\frac{\partial^2 \phi}{\partial x^2} - \frac{\partial^2 \phi}{\partial t^2} = 0 \\ 
\frac{\partial \phi (0,t)}{\partial x} = u_0 (t, \phi(0,t), \dot{\phi}(0,t)) \\ 
\frac{\partial \phi (1,t)}{\partial t} + Z \frac{\partial \phi (1,t)}{\partial x} = 0 \\
\frac{\partial}{\partial x} \phi(x,0)=0
\end{split}
\end{equation}
The quantity $u_0 (t, \phi(0,t), \dot{\phi}(0,t))$ is the driving velocity entering the upper vocal tract from the vocal folds. It depends on the velocity potential in the vocal tract at $x=0$ due to feedback. However from now on we will suppress these arguments and indicate its time derivative with $\dot{u_0}$. We can remove the inhomogeneous boundary condition at $x=0$ with the substitution $\phi(x,t)=\psi (x,t)-u_0 \frac{(x-1)^2}{2}$, where $\psi$ is a function that satisfies the homogeneous boundary conditions but has an inhomogeneous driving term in the wave equation.
\begin{equation}
\label{eq:driven_wave}
\begin{split}
\frac{\partial^2 \psi}{\partial x^2} - \frac{\partial^2 \psi}{\partial t^2} = u_0 - \ddot{u}_0 \frac{(x-1)^2}{2} \\ 
\frac{\partial \psi (0,t)}{\partial x} = 0 \\ 
\frac{\partial \psi (1,t)}{\partial t} + Z \frac{\partial \psi (1,t)}{\partial x} = 0 \\
\frac{\partial}{\partial x} \psi(x,0)=0
\end{split}
\end{equation} 
Next let's expand $\psi (x,t)$ on to a set of spatial eigenmodes $\phi_l (x)$. $\psi (x,t) = \sum_{m=0}^\infty q_m(t) \phi_m (x)$. The projections $q_m(t)$ vary with time and are called the modal participation factors. The eigenmodes $\phi_m (x)$ must satisfy the boundary conditions in Eq. \ref{eq:driven_wave}, and for the case of non zero radiation ($Re(Z) \neq 0$) they will be complex and not orthogonal . In the next section we will derive their precise form. Substituting the modal projection of $\psi (x,t)$ into Eq. \ref{eq:driven_wave} we get
\begin{equation}
\label{eq:coupled_equation}
\sum_{m=0}^\infty q_m \phi_m''(x) - \ddot{q}_m \phi_m(x) = u_0 - \ddot{u}_0 \frac{(x-1)^2}{2}.
\end{equation}
Eq. \ref{eq:coupled_equation} is a matrix equation, which can be solved for the modal participation factors. Soon we will turn our attention to the derivation of a suitable set of spatial eigenmodes so the left hand side of the equation can be diagonalized, but first we need to derive an expression for the exit impedance so we have a complete set of boundary conditions for the spatial problem. 

\section{The Exit Impedance}
Note the variables here are distinct from those in the previous section. We'll convert them back and non dimensionalize at the end. To calculate the spatial eigenmodes we first must derive an expression for the exit impedance Z. This can be done by assuming the exit of the pipe is a circular piston of radius $a$ on which each infinitesimal area acts as the infinitesimal source of a spherical wave. The pressure and velocity solutions of the free space spherical wave equation are
\begin{equation}
\label{eq:spherical_wave}
\begin{split}
p(r,t) &= \frac{A}{r} e^{i(\omega t-kr)} \\ v(r,t) &= \frac{Ak}{\rho \omega r} \left( 1 - \frac{i}{kr} \right)e^{i(\omega t-kr)},
\end{split}
\end{equation}
where r is the distance from the source, k is the wave number, $\omega$ is the angular frequency, and A is a constant that depends on the strength of the source. We can determine an expression for A by assuming the source is a sphere of radius $\epsilon$ vibrating with normal velocity $v(\epsilon)$. The volume flow generated at the surface of the sphere is $q = 4 \pi \epsilon^2 v(\epsilon) e^{i \omega t}$. Combining this with Eq. \ref{eq:spherical_wave} we find $A=\frac{q \rho \omega}{4 \pi} \frac{e^{ik\epsilon}}{k\epsilon-i}$. For $k\epsilon \ll 1$ this simplifies to $A \approx \frac{i q \rho \omega}{4 \pi}$. Thus, the infinitesimal pressure generated by a small area $dS$ on another area $dS'$ is
\begin{equation}
\label{eq:dp_at_ds_prime}
dp_{dS'} = \frac{i \rho \omega}{4 \pi} \frac{e^{i(\omega t-k|\textbf{r}-\textbf{r}^\prime|)}}{|\textbf{r}-\textbf{r}^\prime|} dq = \frac{i U_0 \rho \omega}{4 \pi} \frac{e^{i(\omega t-k|\textbf{r}-\textbf{r}^\prime|)}}{|\textbf{r}-\textbf{r}^\prime|} dS,
\end{equation}  
where $|\textbf{r}-\textbf{r}^\prime|$ is the distance between $dS$ and $dS'$. The second equality comes from the fact that the acoustic strength of the small piece of area is given by $dq = U_0 dS$, where $U_0$ is the velocity flowing through that area. We can find the total pressure on $dS'$ by integrating Eq. \ref{eq:dp_at_ds_prime} over the $s$ coordinate.
\begin{equation}
\label{eq:p_at_ds_prime}
p_{dS'} = \frac{i U_0 \rho \omega}{4 \pi} \int \frac{e^{i(\omega t-k|\textbf{r}-\textbf{r}^\prime|)}}{|\textbf{r}-\textbf{r}^\prime|} dS.
\end{equation}
The infinitesimal force generated on the piston by the pressure on $dS'$ is $df = p_{dS'} dS'$. Thus, we can find the total force on the piston by multiplying Eq. \ref{eq:p_at_ds_prime} by $dS'$ and integrating over the $s'$ coordinate.
\begin{equation}
f = \frac{i U_0 \rho \omega}{4 \pi} \int \int \frac{e^{i(\omega t-k|\textbf{r}-\textbf{r}^\prime|)}}{|\textbf{r}-\textbf{r}^\prime|} dS dS'.
\end{equation}
Evaluating this integral we find
\begin{equation}
f=\rho c \pi a^2 U_0 e^{i \omega t} \left(1 - \frac{J_1(2ka)}{ka} + i \frac{H_1(ka)}{ka} \right),
\end{equation}
where $J_1$ is the Bessel function of the first kind of order 1 and $H_1$ is the Stuve function of order 1. Recalling from the the previous section the specific acoustic impedance of the piston for a sinusoidal driving force of frequency $\omega$ is defined as 
\begin{equation}
Z = \frac{p}{U_0 e^{i \omega t}} = \frac{f/ \pi a^2 }{U_0 e^{i \omega t}}.
\end{equation}
Substituting in our expression for $f$ we get
\begin{equation}
Z = \rho c \left(1 - \frac{J_1(2ka)}{ka} + i \frac{H_1(ka)}{ka} \right).
\end{equation}
In non-dimensional variables this becomes
\begin{equation}
\label{eq:impedance}
Z^* = \left(1 - \frac{J_1(2\omega^*a^*)}{\omega^*a^*} + i \frac{H_1(\omega^*a^*)}{\omega^*a^*} \right).
\end{equation}
Thus, we can think of the end of the pipe as an acoustic load with resistance $R* = \left(1 - \frac{J_1(2\omega^*a^*)}{\omega^*a^*} \right)$ and reactance $X* = \frac{H_1(\omega^*a^*)}{\omega^*a^*}$. From now on we will drop the stars in these quantities to indicate they are non dimensional. Now that we have an expression for the exit impedance the spatial boundary value problem is well determined, and we can calculate the spatial eigenmodes.

\section{The Spatial Eigenmodes}
We can find a set of spatial eigenmodes by solving the initial-boundary value problem
\begin{equation}
\label{eq:homogenous_wave}
\begin{split}
\frac{\partial^2 \psi_H}{\partial x^2} - \frac{\partial^2 \psi_H}{\partial t^2} = 0\\ 
\frac{\partial \psi_H (0,t)}{\partial x} = 0 \\ 
\frac{\partial \psi_H (1,t)}{\partial t} + Z \frac{\partial \psi_H (1,t)}{\partial x} = 0.
\end{split}
\end{equation} 
This is the homogeneous version of Eqs. \ref{eq:wave} and \ref{eq:driven_wave}. Let's assume a solution of the form $\psi(x,t)=\phi_m(x) e^{s_m t}$, where $s_m = i\omega_m - \alpha_m$. The minus sign in front of $\alpha_m$ indicates we expect the energy of the solutions to decrease with time due the resistive part of $Z$. Substituting this assumption into Eq. \ref{eq:homogenous_wave} we get the boundary value problem
\begin{equation}
\label{eq:spatial_problem}
\begin{split}
\phi_m''(x)-s_m^2 \phi_m(x) = 0 \\
\phi_m'(0)=0 \\
s_m \phi_m(1) + Z \phi_m'(1)=0
\end{split}
\end{equation} 
After applying the boundary condition at $x=0$, the solution to this system (up to a constant scaling factor) is
\begin{equation}
\phi_m(x) = \cosh(s_m x).
\end{equation}
Substituting this solution into the $x=1$ boundary condition we two equations for $\omega_m$ and $\alpha_m$, one for the real part of the boundary condition and one for the imaginary part.
\begin{equation}
\begin{split}
\label{eq:omega_alpha}
\text{Real: \thinspace} \cos(\omega) \cosh(\alpha) - X(\omega) \sin(\omega) \cosh(\alpha)  - R(\omega) \cos(\omega) \sinh(\alpha) = 0 \\
\text{Imaginary: \thinspace} R(\omega) \sin(\omega) \cosh(\alpha) - X(\omega) \cos(\omega) \sinh(\alpha) - \sin(\omega) \sinh(\alpha) = 0
\end{split}
\end{equation}
These equations can be solved numerically. Fig. \ref{fig:omega_alpha} shows a plot of the solutions for the real and imaginary equations for $a=0.375$ (for $L=0.004$ mm this corresponds to a dimensional radius of $a=0.0015$ mm). The intersections of those curves are the eigenvalues of the boundary value problem. Fig. \ref{fig:resistance} shows a plot of $R(\omega)$ as defined in equation \ref{eq:impedance}. When $R(\omega) \approx 1$ the impedance of the pipe exit is approximately equal to the characteristic impedance of the pipe. This corresponds to a situation of perfect radiation with no reflection. These modes are immediately radiated and do not form standing wave patterns that oscillate and interact with the lower modes. Thus only the first two or three modes will be important in practical simulations.

Now that we have calculated the spatial eigenfunctions and eigenvalues, we can return to Eq. \ref{eq:coupled_equation} and continue our derivation of the time domain system. From Eq. \ref{eq:spatial_problem} we know $\phi_m''(x)=s_m^2 \phi_m(x)$. Substituting this into Eq. \ref{eq:coupled_equation} we get
\begin{equation}
\label{eq:coupled_equation2}
\sum_{m=0}^\infty (q_m s_m^2 - \ddot{q}_m) \phi_m(x) = u_0 - \ddot{u}_0 \frac{(x-1)^2}{2}.
\end{equation}
We can write this as a matrix equation by defining the vector $v_m = q_m s_m^2 - \ddot{q}_m$ and matrix $ (\boldsymbol{\Phi})_{xm} = \phi_m(x)$.
\begin{equation}
\label{eq:matrix_eq1}
\boldsymbol{\Phi}.\vec{v} = \vec{1} u_0 - \frac{(\vec{x}-1)^2}{2} \ddot{u}_0
\end{equation}
Because of the inclusion of radiation in the right boundary condition the rows of $\boldsymbol{\Phi}$ are not orthogonal to each other. We can rotate them into a basis in which they are orthogonal by diagonalizing the overlap matrix $S_{ij} = \int_{0}^{1} \phi_i^*(x) \phi_j(x) dx$. This can be done numerically by computing the eigendecomposition of the overlap matrix $\boldsymbol{S}=\boldsymbol{T} \boldsymbol{\Lambda} \boldsymbol{T}^\dagger$. The matrix $\boldsymbol{T}$ possesses the eigenvectors of $\boldsymbol{S}$ as columns and is unitary. The matrix $\boldsymbol{\Lambda}$ is diagonal and has the eigenvalues of $\boldsymbol{S}$ as its nonzero entries. Hence, $\boldsymbol{T}$ rotates $\boldsymbol{S}$ into a basis in which it is diagonal and thus a basis in which the rows of $\boldsymbol{\Phi}$ are orthogonal. We write this new matrix with orthogonal rows as $\widetilde{\boldsymbol{\Phi}}=\boldsymbol{\Phi}.\boldsymbol{T}$. Since $\boldsymbol{T}$ is unitary we can write Eq. \ref{eq:matrix_eq1} as
\begin{equation}
\label{eq:matrix_eq2}
\boldsymbol{\Phi}.\boldsymbol{T}.\boldsymbol{T^\dagger}.\vec{v} = \vec{1} u_0 - \frac{(\vec{x}-1)^2}{2} \ddot{u}_0
\end{equation}
Thus,
\begin{equation}
\label{eq:matrix_eq3}
\widetilde{\boldsymbol{\Phi}}.\boldsymbol{T^\dagger}.\vec{v} = \vec{1} u_0 - \frac{(\vec{x}-1)^2}{2} \ddot{u}_0
\end{equation}
Now multiplying this equation by $\widetilde{\boldsymbol{\Phi}}^\dagger$ we get
\begin{equation}
\label{eq:matrix_eq4}
\boldsymbol{\Lambda}.\boldsymbol{T^\dagger}.\vec{v} = \widetilde{\boldsymbol{\Phi}}^\dagger. \left( \vec{1} u_0 - \frac{(\vec{x}-1)^2}{2} \ddot{u}_0 \right),
\end{equation}
using the fact that $\widetilde{\boldsymbol{\Phi}}^\dagger.\widetilde{\boldsymbol{\Phi}}=\boldsymbol{\Lambda}$. Now multiplying this equation by $(\boldsymbol{\Lambda}.\boldsymbol{T^\dagger})^{-1}$ we get  
\begin{equation}
\label{eq:matrix_eq4}
\vec{v} = \boldsymbol{T^\dagger}.\boldsymbol{\Lambda}^{-1}.\widetilde{\boldsymbol{\Phi}}^\dagger. \left( \vec{1} u_0 - \frac{(\vec{x}-1)^2}{2} \ddot{u}_0 \right).
\end{equation}
Converting this equation back to component form it becomes
\begin{equation}
\label{eq:non_zero_dissipation}
\ddot{q}_m - s_m^2 q_m = -(\boldsymbol{T}.\boldsymbol{\Lambda}^{-1}.\widetilde{\boldsymbol{\Phi}}^\dagger.\vec{1})_m u_0 + (\boldsymbol{T}.\boldsymbol{\Lambda}^{-1}.\widetilde{\boldsymbol{\Phi}}^\dagger.\frac{(\vec{x}-1)^2}{2})_m \ddot{u}_0.
\end{equation}
Finally expanding out $s_m^2=-(\omega_m^2 - \alpha_m^2) \left( 1 +  i \frac{2 \alpha_m \omega_m}{\omega_m^2 - \alpha_m^2} \right)$, we get
\begin{equation}
\label{eq:hysteretic_damping}
\ddot{q}_m + (\omega_m^2 - \alpha_m^2) \left( 1 +  i \frac{2 \alpha_m \omega_m}{\omega_m^2 - \alpha_m^2} \right) q_m = -(\boldsymbol{T}.\boldsymbol{\Lambda}^{-1}.\widetilde{\boldsymbol{\Phi}}^\dagger.\vec{1})_m u_0 + (\boldsymbol{T}.\boldsymbol{\Lambda}^{-1}.\widetilde{\boldsymbol{\Phi}}^\dagger.\frac{(\vec{x}-1)^2}{2})_m \ddot{u}_0.
\end{equation}

\section{The Viscous Damping Approximation}
The term with the imaginary constant in Eq. \ref{eq:hysteretic_damping} is known as a hysteretic damping term. Although unproblematic in the frequency domain, hysteretic damping results in complications when included in time domain simulations. This is a result of Eq. \ref{eq:hysteretic_damping} admitting non causal solutions, in addition to the physically meaningful ones. Attempting to enforce causality in numerical time domain simulations is difficult. An alternate method of dealing with this problem is to find an equation that possesses a viscous damping term that is equivalent to the hysteretic damping term. That is if we have equations of the form
\begin{equation}
\label{eq:viscous}
\ddot{q}_m + \beta_m \dot{q}_m +(\omega_m^2 - \alpha_m^2) q_m = -(\boldsymbol{T}.\boldsymbol{\Lambda}^{-1}.\widetilde{\boldsymbol{\Phi}}^\dagger.\vec{1})_m u_0 + (\boldsymbol{T}.\boldsymbol{\Lambda}^{-1}.\widetilde{\boldsymbol{\Phi}}^\dagger.\frac{(\vec{x}-1)^2}{2})_m \ddot{u}_0,
\end{equation}
can we find constants $\beta_m$ such that Eqs. \ref{eq:eq:viscous} approximate Eqs. \ref{eq:eq:hysteretic_damping}. To do this take the undriven versions of Eqs. \ref{eq:eq:hysteretic_damping} and \ref{eq:eq:viscous} and assume a harmonic solution $q_m(t) = e^{i \omega t}$.
\begin{equation}
\begin{split}
- \omega_h^2 + (\omega_m^2 - \alpha_m^2) \left( 1 +  i \frac{2 \alpha_m \omega_m}{\omega_m^2 - \alpha_m^2} \right) &= 0 \\
- \omega_v^2 + i \beta_m \omega_v + (\omega_m^2 - \alpha_m^2) & = 0,
\end{split}
\end{equation}
where we use the subscripts $h$ and $v$ to denote the operating frequencies for the hysteretic and viscous equations respectively. The principle solutions of these equations are 
\begin{equation}
\begin{split}
\label{eq:operating_frequencies}
\omega_h &= \sqrt{\omega_m^2 - \alpha_m^2} \sqrt{1 +  i \frac{2 \alpha_m \omega_m}{\omega_m^2 - \alpha_m^2} } \\
\omega_v &= \sqrt{\omega_m^2 - \alpha_m^2 - \beta_m^2} + i \frac{\beta_m}{2}.
\end{split}
\end{equation}
Ideally we would choose $\beta_m$ such that $\omega_h=\omega_v$, but this results in an equation with no solution. However we can minimize a measure of the distance between them by solving the equation
\begin{equation}
\label{eq:frequency_distance}
\frac{\partial}{\partial \beta_m} |\omega_h - \omega_v|^2 = 0,
\end{equation}
which is satisfied when
\begin{equation}
\label{eq:beta}
\beta_m = 2 \sqrt{\omega_m^2 - \alpha_m^2} \sin \left( \frac{\arctan \left( \frac{2 \alpha_m \omega_m}{\omega_m^2 - \alpha_m^2} \right)}{2} \right) 
\end{equation}
Thus, if we use Eq. \ref{eq:beta} for $\beta_m$ the viscous damping in Eq. \ref{eq:viscous} approximate the hysteretic damping in Eq. \ref{eq:hysteretic_damping}. Additionally the viscous damping approximation decouples the real and imaginary parts of Eq. \ref{eq:hysteretic_damping}. So we can define $a_m = Re((\boldsymbol{T}.\boldsymbol{\Lambda}^{-1}.\widetilde{\boldsymbol{\Phi}}^\dagger.\vec{1})_m)$, $b_m=Re((\boldsymbol{T}.\boldsymbol{\Lambda}^{-1}.\widetilde{\boldsymbol{\Phi}}^\dagger.\frac{(\vec{x}-1)^2}{2})_m)$, and write
\begin{equation}
\label{eq:viscous2}
\ddot{q}_m + \beta_m \dot{q}_m +(\omega_m^2 - \alpha_m^2) q_m = -a_m u_0 +b_m \ddot{u}_0.
\end{equation}  
\section{The Driving Velocity, Nonlinearities, and Feedback}
With Eq. \ref{eq:hysteretic_damping} we have successfully solved the spatial part of the problem. We now have a time domain damped oscillator equation, whose driving term depends on $u_0$ and its derivatives. Now all that's left in the derivation of the model is expressing the driving velocity in terms of the tracheal pressure and the geometry of the vocal folds. The velocity of the vocal fold flow is on the order of $30 \thinspace \frac{m}{s}$, and the vocal radius is on the order of $1 \thinspace mm$. So the Reynold's number of the vocal fold flow is on the order of $2000$. Thus, it's valid to expect the flow through the vocal folds to be conservative. Therefore we can use Bernoulli's equation, expressing energy conservation of the flow between the trachea ($T$) and pharyngeal end of the glottis ($G$).  
\begin{equation}
\label{eq:energy1}
(p_{G} - p_{T}) + \frac{1}{2}(|u_{G}|^2 - |u_{T}|^2) + \frac{\partial}{\partial t} (\phi_{G} - \phi_{T}) = 0.
\end{equation}  

We also assume the vocal fold flow is incompressible. We don't have precise measurements for the thickness of the vocal folds. However the shortest acoustic wavelengths emitted by the rodent vocal tract are on the order of $4 \thinspace mm$. Incompressibility is a good assumption as long the vocal fold thickness is less than half that. Since the vocal fold radius is about $1 \thinspace mm$, this is reasonable even for the highest frequency modes. Thus, from continuity of mass and the incompressibility of the flow we have $u_{T}=\frac{A_{G}}{A_{T}}u_{G}$. Furthermore, the change in velocity potential can be expressed as $\phi_{G} - \phi_{T} = \int_{T}^{G} u(x) dx$, where $u(x)$ is the axially varying flow velocity inside the folds. Using conservation of mass again we can write this in terms of the velocity at the glottal end $\phi_{G} - \phi_{T} = A_{G} u_{G} \int_{T}^{G} \frac{dx}{A(x)}$, where $A(x)$ is the axially varying area of the folds. Inserting these equations into Eq. \ref{eq:energy1} we get.
\begin{equation}
\label{eq:energy2}
(p_{G} - p_{T}) + \frac{1}{2} |u_{G}|^2 \left(1 - \left( \frac{A_{G}}{A_{T}} \right)^2 \right) + \frac{\partial}{\partial t} \left( A_{G} u_{G} \int_{T}^{G} \frac{dx}{A(x)} \right) = 0.
\end{equation} 
The velocity $u_{G}$ will be fed into the upper vocal tract exciting acoustic resonances. This is the feed-forward element of the system. After a short distance the flow emerging from the vocal folds will mix withe acoustic flow of the upper vocal tract. We can use conservation of mass one last time to relate the flow emerging from the vocal folds to $u_0$, the driving velocty in Eqs. \ref{eq:zero_dissipation} and \ref{eq:hysteretic_damping}, $A_{G} u_{G} = u_0 A_0$. Inserting this into Eq. \ref{eq:energy2} we get 
\begin{equation}
\label{eq:energy3}
(p_{G} - p_{T}) + \frac{1}{2} |u_{0}|^2 \left( \left( \frac{A_{0}}{A_{G}} \right)^2- \left( \frac{A_{0}}{A_{T}} \right)^2 \right) + \frac{\partial}{\partial t} \left( A_{0} u_{0} \int_{T}^{G} \frac{dx}{A(x)} \right) = 0.
\end{equation} 
By continuity of pressure $p_{G}$ must equal the acoustic pressure response generated in the upper vocal tract at $x=0$. Thus, $p_{G}=-\frac{\partial Re(\phi(0,t))}{\partial t}=-\sum_l{Re(\dot{q}_l)} + \frac{\dot{u}_0}{2}$. This is the feedback condition, since the driving velocity $u_0$ will excite a pressure response in the resonator, which will impede further flow. Again by continuity of pressure $p_{T}$ must equal the pressure in the trachea. This is the input to the system, and we will just call it $p$, with the understanding that it can be made to vary in time. Inserting these equations into Eq. \ref{eq:energy3} we get 
\begin{equation}
\label{eq:energy4}
-\sum_l{\dot{q}_l} + \frac{\dot{u}_0}{2} - p + \frac{1}{2} |u_{0}|^2 \left( \left( \frac{A_{0}}{A_{G}} \right)^2- \left( \frac{A_{0}}{A_{T}} \right)^2 \right) + \frac{\partial}{\partial t} \left( A_{0} u_{0} \int_{T}^{G} \frac{dx}{A(x)} \right) = 0.
\end{equation}
We can simplify this equation by defining the defining the area rations $C_E = \frac{A_{0}}{A_{G}}$ (expansion coefficient) and $C_C = \frac{A_G}{A_t}$ (contraction coefficient.
\begin{equation}
\label{eq:energy5}
-\sum_l{Re(\dot{q}_l)} + \frac{\dot{u}_0}{2} - p + \frac{C_E^2}{2} |u_{0}|^2 \left( 1 - C_C^2 \right) + \frac{\partial}{\partial t} \left( A_{0} u_{0} \int_{T}^{G} \frac{dx}{A(x)} \right) = 0.
\end{equation}

We can also simplify the derivative term by assuming a profile for the vocal folds. Since we don't have detailed measurements of the geometry of the vocal folds, there is little point at this time to attempt to provide precise numerical predictions. Instead it is of more value to provide mechanistic understanding of the acoustic production mechanism. With this in mind we assume the vocal folds to have a linear converging profile. In this case, the axially varying area can be written as 
\begin{equation}
\label{eq:area1}
A(x)= \left(\sqrt{A_G}-\sqrt{A_{GT}}\right)^2 \left(\frac{x}{l}  \right)^2- 2 \sqrt{A_{GT}} \left(\sqrt{A_{GT}}-\sqrt{A_G}\right)\frac{x}{l}+A_{GT},
\end{equation}
where $l$ is the length of the vocal folds and $A_{GT}$ is the area of the vocal folds on the tracheal side. Eq. \ref{eq:area1} simplifies somewhat if we write it in terms of $C_F = \frac{A_{TG}}{A_G}$ (the fold coefficient), the area ratio of the tracheal and pharyngeal sides of the vocal folds.
\begin{equation}
\label{eq:area2}
\frac{A(x)}{A_G} = \left( 1-\sqrt{C_F} \right)^2 \left( \frac{x}{l} \right)^2 + 2\left( \sqrt{C_F} - C_F \right) \frac{x}{l} + C_F.
\end{equation}
Evaluating the integral in Eq. \ref{eq:energy4}
\begin{equation}
A_0 \int_{T}^{G} \frac{dx}{A(x)} = C_E  \frac{l}{\sqrt{C_F}} = C_E l_e
\end{equation}
where $l_e =  \frac{l}{\sqrt{C_F}}$ (the effective length of the vocal folds). Inserting these expressions into Eq. \ref{eq:energy4} we get
\begin{equation}
\label{eq:energy6}
-\sum_l{Re(\dot{q}_l)} + \frac{\dot{u}_0}{2} - p + \frac{1}{2} |u_{0}|^2 C_E^2 \left( 1 - C_C^2 \right) + \frac{\partial}{\partial t}( u_{0} C_E l_e ) = 0.
\end{equation} 
Is is also reasonable to assume the time derivatives of $C_E$ and $l_e$ are negligible compared to those of $u_0$ and $q_n$, since the acoustic oscillations have a much higher frequency than is physically possible for the vocal folds to maintain. Thus, we can take them out of the time derivative in Eq. \ref{eq:energy5}
\begin{equation}
\label{eq:energy7}
-\sum_l{Re(\dot{q}_l)} - p + \frac{1}{2} |u_{0}|^2 C_E^2 \left( 1 - C_C^2 \right) + \left( C_E l_e + \frac{1}{2}  \right) \dot{u}_0 = 0.
\end{equation} 
\ref{eq:energy7} is a feedback condition, which puts an energy constraint on the solutions of Eq. \ref{eq:hysteretic_damping}. It has the effect of introducing a nonlinearity into the system through its quadratic term, which is responsible for limiting the amplitude of acoustic oscillations. The nonlinear terms has the interpretation of representing the energy loss due to vortex formation as the flow passes around sharp edges.
\section{The Unsteady Force Due to Vorticity Creation}
The force that must be applied to a fluid of volume $V$ to generate vorticity $\boldsymbol{\omega}(t)$ inside the volume is 
\begin{equation}
\textbf{F}_{\omega}(t) = \frac{\rho}{2} \frac{\partial}{\partial t} \int_V \textbf{r} \times \boldsymbol{\omega}(t) dV.
\end{equation}
As a simple model of vortex creation we consider the axisymmetric jet emerging from the vocal folds of radius $r_f$. The mean flow inside the jet is constant in space and quasistatic in time. The jet is surrounded by a thin boundary layer of radius $\delta$ in which the mean flow decreases linearly to $0$.
\begin{equation}
\textbf{U} = \begin{cases}
U_0\ \hat{x} & 0 \leq r < r_f \\ 
U_0\frac{r_f + \delta - r}{\delta}\ \hat{x} & r_f \leq r < r_f + \delta \\
0\ \hat{x} & r_f + \delta \leq r < r_0
\end{cases}
\end{equation}
From this assumption it can be seen that the mean flow vorticity is $\boldsymbol{\Omega} = \frac{U_0}{\delta} \hat{phi}$ inside the jet boundary layer and $0$ outside of it. 

To calculate the unsteady portion of the vorticity let us separate the total flow into the mean flow and a small disturbance $\textbf{u} = \textbf{U} + \epsilon \textbf{u}'$.
\begin{equation}
\textbf{u}' = u_x'(x, r, \phi, t) \hat{x} + u_r'(x, r, \phi, t)  \hat{r} + u_\phi'(x, r, \phi, t)  \hat{\phi}.
\end{equation}
Substituting this assumption into the Euler and continuity equations and gathering terms of order $\epsilon$ we get the linearized Euler and continuity equation for the disturbances
\begin{equation}
\begin{split}
\label{eq:linear_disturbance}
\frac{\partial \textbf{u}' }{\partial t} + U \frac{\partial \textbf{u}'}{\partial x} + u_r' \frac{\partial \textbf{U}}{\partial r} &= -\frac{\nabla p'}{\rho} \\
\nabla \cdot \textbf{u}' &= 0 
\end{split}
\end{equation}
Resolving the disturbances into Fourier components
\begin{equation}
\begin{split}
 \textbf{u}' & = \Re \left[ \left( \hat{u}_x(r), i \hat{u}_r(r), \hat{u}_{\phi}(r) \right) e^{in\phi - i \alpha x + i \omega t}   \right] \\
 p' & = \Re \left[ \hat{p}(r) e^{in\phi - i \alpha x + i \omega t} \right]
\end{split}
\end{equation}
and substituting them into \ref{eq:linear_disturbance} we get
\begin{equation}
\begin{split}
(\omega - \alpha U )\hat{u}_x  + \hat{u}_r U' - \frac{\alpha}{\rho} \hat{p} & = 0 \\
(\omega -  \alpha U )\hat{u}_r - \frac{1}{\rho}\frac{\partial \hat{p}}{\partial r} & = 0 \\
(\omega -  \alpha U ) \hat{u}_{\phi} + \frac{1}{\rho}\frac{n}{r} \hat{p} & = 0 \\
\frac{\partial \hat{u}_r}{\partial r} + \frac{\hat{u}_r}{r} - \alpha \hat{u}_x + \frac{n}{r} \hat{u}_{\phi} &=0.  
\end{split}
\end{equation}
Eliminating other variables to get an equation in $\hat{u}_r$ we get 
\begin{equation}
(\omega - \alpha U) \left( \frac{r}{n^2 + \alpha^2 r^2} \frac{\partial^2 (r \hat{u}_r)}{\partial r^2}  + \frac{n^2-\alpha^2 r^2}{(n^2 + \alpha^2 r^2)^2} \frac{\partial (r \hat{u}_r)}{\partial r} \right)- (\omega - \alpha U) \hat{u}_r -r \hat{u}_r \frac{\partial}{\partial r} \frac{r U'}{n^2 + \alpha^2 r^2}   
\end{equation}


\section{The Time Domain ODEs}
Eqs. \ref{eq:viscous2} and \ref{eq:energy7} form a differential algebraic system that must be solved for a set of ODEs. To do this first solve Eq. \ref{eq:energy7} for $\dot{u}_0$ we get
\begin{equation}
\label{eq:u_dot}
\dot{u}_0 = \mu^{-1} \left(\sum_l{\dot{q}_l} + p -\frac{\gamma}{2} |u_{0}|^2  \right), 
\end{equation}
where we made the substitutions $\mu=C_E L_e + \frac{1}{2}$ and $\gamma = C_E^2 (1 - C_C^2)$. Now differentiating Eq. \ref{eq:u_dot} with respect to time we get 
\begin{equation}
\label{eq:u_ddot}
\ddot{u}_0 = \mu^{-1} \left( \sum_l{\ddot{q}_l} - \gamma u_{0} \dot{u}_0  \right),
\end{equation} 
where we have assumed the pressure varies slowly enough to be treated quasi statically. This assumption may need to be relaxed at some point.

Now substituting Eq. \ref{eq:u_ddot} into Eq. \ref{eq:viscous2} we get 
\begin{equation}
\label{eq:viscous3}
\ddot{q}_m + \beta_m \dot{q}_m +(\omega_m^2 - \alpha_m^2) q_m = -a_m u_0 + \frac{b_m}{\mu}\left( \sum_l{\ddot{q}_l} - \gamma u_{0} \dot{u}_0  \right).
\end{equation} 
Moving the $\sum_l{\ddot{q}_l}$ term to the left hand side we get
\begin{equation}
\label{eq:viscous4}
\sum_l \left( \delta_{ml} -\frac{b_m}{\mu } \right)\ddot{q}_l + \beta_m \dot{q}_m +(\omega_m^2 - \alpha_m^2) q_m = -a_m u_0 - \frac{b_m \gamma}{\mu} u_{0} \dot{u}_0.
\end{equation} 
This is a matrix equation, which must be solved for $\ddot{q}_n$. To do this multiply by the matrix $\textbf{M}$, where $M_{ml}^{-1}=\delta_{ml} -\frac{b_m}{\mu}$, we get
\begin{equation}
\label{eq:viscous5}
\ddot{q}_n + \sum_m M_{nm} \beta_m \dot{q}_m + \sum_m M_{nm} (\omega_m^2 - \alpha_m^2) q_m = -A_n u_0 - \frac{B_n \gamma}{\mu} u_{0} \dot{u}_0,
\end{equation} 
where $A_n = \sum_m M_{nm} a_m$ and $B_n = \sum_m M_{nm} b_m$. Finally, we substitute Eq. \ref{eq:u_dot} into Eq. \ref{eq:viscous5} to get Eq. \ref{eq:viscous5}. Our set of time domain ODEs for the variables $(u_0,...,q_n,...\dot{q}_n,...)$ is then
\begin{equation}
\label{eq:u_dot}
\dot{u}_0 = \mu^{-1} \left(\sum_m{\dot{q}_m} + p -\frac{\gamma}{2} |u_{0}|^2  \right) 
\end{equation}
\begin{equation}
\label{eq:viscous6}
\ddot{q}_n + \sum_m M_{nm} \beta_m \dot{q}_m + \sum_m M_{nm} (\omega_m^2 - \alpha_m^2) q_m = -\left(A_n + B_n  \frac{\gamma }{\mu^2}p \right) u_0 - B_n  \frac{\gamma }{\mu^2} \left(u_0 \sum_m{\dot{q}_m} - \frac{\gamma}{2} u_{0}^3 \right).
\end{equation} 
Bringing the nonlinear dissipation term to the left side
\begin{equation}
\label{eq:viscous7}
\ddot{q}_n + \sum_m (M_{nm} \beta_m + B_n \frac{\gamma }{\mu^2} u_0) \dot{q}_m + \sum_m M_{nm} (\omega_m^2 - \alpha_m^2) q_m = -\left(A_n + B_n  \frac{\gamma }{\mu^2}p \right) u_0 + B_n  \frac{\gamma^2 }{2\mu^2} u_{0}^3.
\end{equation}
Writing this in vector form it becomes
\begin{equation}
\label{eq:viscous7}
\vec{\ddot{q}} + (\boldsymbol{D} + \vec{B} \frac{\gamma }{\mu^2} u_0) \vec{\dot{q}} + \boldsymbol{K} \vec{q} = -\left(\vec{A} + \vec{B}  \frac{\gamma }{\mu^2}p \right) u_0 + \vec{B}  \frac{\gamma^2 }{2\mu^2} u_{0}^3,
\end{equation}  
where the matrices $D_{nm}=M_{nm} \beta_m$ and $K_{nm}=M_{nm} (\omega_m^2 - \alpha_m^2)$.
\section{The Jacobian and Fixed Points}
\begin{equation}
J(n,m) = \begin{cases}
-\frac{\gamma}{\mu} u_0 & n=0, m=0 \\
0 & n=0, 1 \leq m < N + 1 \\
\frac{1}{\mu} & n=0, N + 1 \leq m < 2 N +1 \\
0 & 1 \leq n < N+1, 0 \leq m < N+1 \\
\delta_{n,m-N} & 1 \leq n < N+1, N+1 \leq m < 2N+1 \\ 
-\frac{B_n \gamma \sum_l \dot{q}_l}{\mu^2} - A_n - \frac{B_n \gamma p }{\mu^2} + \frac{3 B_n \gamma^2 u_0^2}{2 \mu^2}  & N+1 \leq n < 2N+1, m=0\\
-K_{nm} & N+1 \leq n < 2N+1, 1 \leq m < N+1 \\
-D_{nm} - \frac{B_n \gamma u_0}{\mu^2} & N+1 \leq n < 2N+1, N+1 \leq m < 2N+1 \\

\end{cases}
\end{equation}
\end{document}
